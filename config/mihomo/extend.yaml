### 全局配置
mixed-port: 7890 # HTTP(S) + SOCKS 混合代理端口，Clash 主代理入口
allow-lan: true # 允许局域网设备连接本机代理
mode: rule # 代理模式，使用规则分流
bind-address: "*" # 绑定所有网卡地址，使局域网内其他设备可访问
ipv6: false # 禁用 IPv6，防止 DNS 泄露及访问异常
log-level: debug # 日志等级，调试时推荐设置为 debug
profile:
  store-selected: true # 记住上次选择的节点或策略
  store-fake-ip: true # 记住 fake-ip 映射关系，提升命中率
unified-delay: true # 启用统一延迟计算
tcp-concurrent: true # TCP 并发连接，提升连接速度
global-client-fingerprint: chrome # 全局默认浏览器指纹，用于模拟真实浏览器行为

### DNS 配置
dns:
  enable: true # 启用内置 DNS 服务器
  prefer-h3: true # 优先使用 HTTP/3（QUIC）协议解析 DNS 请求
  ipv6: false # 不解析 AAAA 记录，避免走 IPv6
  enhanced-mode: fake-ip # 使用 fake-ip 模式，防止 DNS 泄露
  fake-ip-range: 198.18.0.1/16 # 用于 fake-ip 映射的 IP 段（保留地址段）
  fake-ip-filter: # fake-ip 排除列表，这些域名将使用真实 IP 解析，防止功能异常
    # 本地主机/设备
    - +.lan
    - +.local
    # Windows网络出现小地球图标
    - +.msftconnecttest.com
    - +.msftncsi.com
    # QQ快速登录检测失败
    - localhost.ptlogin2.qq.com
    - localhost.sec.qq.com
    # 追加以下条目
    - +.in-addr.arpa
    - +.ip6.arpa
    - time.*.com
    - time.*.gov
    - pool.ntp.org
    # 微信快速登录检测失败
    - localhost.work.weixin.qq.com
  respect-rules: true # DNS 查询也按 Clash 规则处理
  nameserver: # 直连使用的 DNS 服务器（DoH）
    - https://223.5.5.5/dns-query # 阿里公共 DNS
    - https://doh.pub/dns-query # 腾讯公共 DNS
  proxy-server-nameserver: # 被规则判断为走代理的域名使用此处 DNS
    - https://1.1.1.1/dns-query # Cloudflare DoH
    - https://8.8.8.8/dns-query # Google DoH

proxies:
  - { name: "🇯🇵日本claw"}
  - { name: "🇺🇸美国dmit"}

### 出站策略锚点（用于复用）
pr: &pr { type: select, proxies: [ 节点选择, 自动选择, 🇯🇵日本claw, 🇺🇸美国dmit, 全局直连 ] }

### 代理组定义
proxy-groups:
  - { name: 节点选择, type: select, proxies: [ 自动选择, 🇯🇵日本claw, 🇺🇸美国dmit ] ,icon: https://fastly.jsdelivr.net/gh/clash-verge-rev/clash-verge-rev.github.io@main/docs/assets/icons/adjust.svg }
  - { name: 自动选择, type: url-test, include-all: true, tolerance: 20, interval: 300, filter: "^((?!(全局直连)).)*$" ,icon: https://fastly.jsdelivr.net/gh/clash-verge-rev/clash-verge-rev.github.io@main/docs/assets/icons/speed.svg }
  - { name: Google, <<: *pr ,icon: https://fastly.jsdelivr.net/gh/clash-verge-rev/clash-verge-rev.github.io@main/docs/assets/icons/google.svg }
  - { name: YouTube, <<: *pr ,icon: https://fastly.jsdelivr.net/gh/clash-verge-rev/clash-verge-rev.github.io@main/docs/assets/icons/youtube.svg }
  - { name: Netflix, <<: *pr , icon: https://fastly.jsdelivr.net/gh/xiaolin-007/clash@main/icon/netflix.svg }
  - { name: ChatGPT, <<: *pr , icon: https://fastly.jsdelivr.net/gh/clash-verge-rev/clash-verge-rev.github.io@main/docs/assets/icons/chatgpt.svg }
  - { name: Microsoft, <<: *pr , icon: https://fastly.jsdelivr.net/gh/clash-verge-rev/clash-verge-rev.github.io@main/docs/assets/icons/microsoft.svg }
  - { name: Telegram, <<: *pr ,icon: https://fastly.jsdelivr.net/gh/clash-verge-rev/clash-verge-rev.github.io@main/docs/assets/icons/telegram.svg }
  - { name: Spotify, <<: *pr ,icon: https://fastly.jsdelivr.net/gh/xiaolin-007/clash@main/icon/spotify.svg }
  - { name: Apple, <<: *pr , icon: https://fastly.jsdelivr.net/gh/clash-verge-rev/clash-verge-rev.github.io@main/docs/assets/icons/apple.svg }
  - { name: 漏网之鱼, <<: *pr , icon: https://fastly.jsdelivr.net/gh/clash-verge-rev/clash-verge-rev.github.io@main/docs/assets/icons/fish.svg }
  - { name: 全局直连, type: select, proxies: [ DIRECT ], icon: https://fastly.jsdelivr.net/gh/clash-verge-rev/clash-verge-rev.github.io@main/docs/assets/icons/link.svg }

# 规则配置
RuleSet_classical: &RuleSet_classical { type: http, behavior: classical, interval: 43200, format: text, proxy: 节点选择 }
RuleSet_domain: &RuleSet_domain { type: http, behavior: domain, interval: 43200, format: text, proxy: 节点选择 }
RuleSet_ipcidr: &RuleSet_ipcidr { type: http, behavior: ipcidr, interval: 43200, format: text, proxy: 节点选择 }

# 订阅规则
rule-providers:
  reject:
    <<: *RuleSet_domain
    url: https://fastly.jsdelivr.net/gh/Loyalsoldier/clash-rules@release/reject.txt
    path: ./ruleset/loyalsoldier/reject.yaml

  icloud:
    <<: *RuleSet_domain
    url: https://fastly.jsdelivr.net/gh/Loyalsoldier/clash-rules@release/icloud.txt
    path: ./ruleset/loyalsoldier/icloud.yaml

  apple:
    <<: *RuleSet_domain
    url: https://fastly.jsdelivr.net/gh/Loyalsoldier/clash-rules@release/apple.txt
    path: ./ruleset/loyalsoldier/apple.yaml

  google:
    <<: *RuleSet_domain
    url: https://fastly.jsdelivr.net/gh/Loyalsoldier/clash-rules@release/google.txt
    path: ./ruleset/loyalsoldier/google.yaml

  proxy:
    <<: *RuleSet_domain
    url: https://fastly.jsdelivr.net/gh/Loyalsoldier/clash-rules@release/proxy.txt
    path: ./ruleset/loyalsoldier/proxy.yaml

  direct:
    <<: *RuleSet_domain
    url: https://fastly.jsdelivr.net/gh/Loyalsoldier/clash-rules@release/direct.txt
    path: ./ruleset/loyalsoldier/direct.yaml

  private:
    <<: *RuleSet_domain
    url: https://fastly.jsdelivr.net/gh/Loyalsoldier/clash-rules@release/private.txt
    path: ./ruleset/loyalsoldier/private.yaml

  gfw:
    <<: *RuleSet_domain
    url: https://fastly.jsdelivr.net/gh/Loyalsoldier/clash-rules@release/gfw.txt
    path: ./ruleset/loyalsoldier/gfw.yaml

  tld-not-cn:
    <<: *RuleSet_domain
    url: https://fastly.jsdelivr.net/gh/Loyalsoldier/clash-rules@release/tld-not-cn.txt
    path: ./ruleset/loyalsoldier/tld-not-cn.yaml

  telegramcidr:
    <<: *RuleSet_ipcidr
    url: https://fastly.jsdelivr.net/gh/Loyalsoldier/clash-rules@release/telegramcidr.txt
    path: ./ruleset/loyalsoldier/telegramcidr.yaml

  cncidr:
    <<: *RuleSet_ipcidr
    url: https://fastly.jsdelivr.net/gh/Loyalsoldier/clash-rules@release/cncidr.txt
    path: ./ruleset/loyalsoldier/cncidr.yaml

  lancidr:
    <<: *RuleSet_ipcidr
    url: https://fastly.jsdelivr.net/gh/Loyalsoldier/clash-rules@release/lancidr.txt
    path: ./ruleset/loyalsoldier/lancidr.yaml

  applications:
    <<: *RuleSet_classical
    url: https://fastly.jsdelivr.net/gh/Loyalsoldier/clash-rules@release/applications.txt
    path: ./ruleset/loyalsoldier/applications.yaml

  YouTube:
    <<: *RuleSet_classical
    url: https://fastly.jsdelivr.net/gh/xiaolin-007/clash@main/rule/YouTube.txt
    path: ./ruleset/xiaolin-007/YouTube.yaml

  Netflix:
    <<: *RuleSet_classical
    url: https://fastly.jsdelivr.net/gh/xiaolin-007/clash@main/rule/Netflix.txt
    path: ./ruleset/xiaolin-007/Netflix.yaml

  Spotify:
    <<: *RuleSet_classical
    url: https://fastly.jsdelivr.net/gh/xiaolin-007/clash@main/rule/Spotify.txt
    path: ./ruleset/xiaolin-007/Spotify.yaml

# 分流规则
rules:
  - DOMAIN-SUFFIX,infini.money,🇯🇵日本claw
  - DOMAIN-SUFFIX,piggo.me,全局直连
  - DOMAIN-SUFFIX,googleapis.cn,节点选择
  - DOMAIN-SUFFIX,gstatic.com,节点选择
  - DOMAIN-SUFFIX,xn--ngstr-lra8j.com,节点选择
  - DOMAIN-SUFFIX,github.io,节点选择
  - DOMAIN,v2rayse.com,节点选择
  - RULE-SET,applications,全局直连
  - RULE-SET,private,全局直连
  - RULE-SET,icloud,全局直连
  - RULE-SET,apple,Apple
  - RULE-SET,YouTube,YouTube
  - RULE-SET,Netflix,Netflix
  - RULE-SET,Spotify,Spotify
  - RULE-SET,google,Google
  - RULE-SET,proxy,节点选择
  - RULE-SET,gfw,节点选择
  - RULE-SET,tld-not-cn,节点选择
  - RULE-SET,direct,全局直连
  - RULE-SET,lancidr,全局直连,no-resolve
  - RULE-SET,cncidr,全局直连,no-resolve
  - RULE-SET,telegramcidr,Telegram,no-resolve
  - GEOIP,LAN,全局直连,no-resolve
  - GEOIP,CN,全局直连
  - MATCH,漏网之鱼
